<template>
    <div class="slds-card">
        <div class="slds-page-header">
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <lightning-icon icon-name="standard:customers"></lightning-icon>
                        </div>
                        <div class="slds-media__body">
                        <div class="slds-page-header__name">
                            <div class="slds-page-header__name-title">
                                <h1>
                                    <span class="slds-page-header__title slds-truncate slds-var-m-top_xx-small" title="Collaborators">Collaborators</span>
                                </h1>
                            </div>
                        </div>
                        <span style="font-size:medium" title="Count of Included Collaborators. Max allowed CC Emails is 25">
                            <span style={get_collabCounterStyle}>({get_activeCollaborators}/25)</span>
                        </span>
                    </div>
                </div>
                </div>
                <div class="slds-page-header__col-actions">
                    <div class="slds-page-header__controls">
                        <div class="slds-page-header__control">
                            <lightning-button-icon 
                                icon-name="utility:refresh"   
                                variant="border-filled" 
                                alternative-text="Refresh Collaborators"  
                                title="Refresh Collaborators"
                                onclick={getExistingCollaborators}>
                            </lightning-button-icon>

                            <lightning-button-menu 
                                variant="border-filled"
                                alternative-text="Show Menu" 
                                tooltip="Show Menu"  
                                menu-alignment="right" 
                                icon-name="utility:apps" 
                                class="slds-m-left_xx-small"
                                onselect={handleMenuActions}>
                                <lightning-menu-item 
                                    icon-name="utility:leave_conference"
                                    value="manageExclusions" 
                                    label="Manage Exclusions">
                                </lightning-menu-item>
                                <lightning-menu-item 
                                    icon-name="utility:add"
                                    value="adHocCollaborator" 
                                    label="Add Ad-hoc Collaborator (Email)">
                                </lightning-menu-item>
                                <lightning-menu-item 
                                    icon-name="utility:question_mark"
                                    value="aboutTool" 
                                    label="About this Tool">
                                </lightning-menu-item>
                            </lightning-button-menu>
                        </div>
                    </div>
                </div>
            </div>
            <template if:false={get_collabCounterOverLimit}>
                <div class="slds-page-header__row">
                    <div class="slds-page-header__col-meta slds-var-m-top_x-small">
                        <!-- <div class="slds-grid">
                            <div class="slds-col slds-col_bump-right" style="width: 100%;"> -->
                                <lightning-input
                                    name="enter-search"
                                    placeholder="Search & Add Collaborators... [Hit Enter]"
                                    type="search"
                                    onkeypress={searchCollaborators}
                                    onchange={handleSearchChange}
                                    variant="label-hidden"
                                ></lightning-input>
                            <!-- </div>
                            <div class="slds-col">
                                <lightning-button 
                                    icon-name="utility:add"   
                                    variant="border-filled" 
                                    alternative-text="Add Ad-hoc Email Address to Collaborators"  
                                    title="Add Ad-hoc Email Address to Collaborators"
                                    onclick={excludeCollaborator}
                                    label="Email">
                                </lightning-button>
                            </div>
                        </div> -->
                        
                        <!-- <template if:true={get_collabCounterOverLimit}>
                            <span class="collabLimitedReached">Collaborator Limit Reached!</span>
                        </template> -->
                        
                    </div>
                </div>
            </template>
        </div>


        <div class="slds-var-p-horizontal_small slds-var-p-vertical_medium slds-scrollable_y"
        style="max-height: 250px;">
            <!-- &ThinSpace; -->

            <!-- CLOSE TO LIMIT PROMPT -->
            <template if:true={get_collabCounterCloseToLimit}>
                <div class="promptBoxCloseToLimit">
                    You are close to your Collaborator Limit for this Case!
                    <br/>If you add CC Contacts to the Email when sending, then this could risk some Collaborators not being added to the Email.
                </div>
            </template>

            <template if:true={get_foundCollaborators}>
                <template for:each={existingCollaborators} for:item="collaborator">
                    
                    <span key={collaborator.Id} class="slds-pill slds-pill_link slds-var-m-bottom_xx-small slds-var-m-horizontal_xxx-small"
                    style={collaborator.style}>
                        <span class="slds-pill__icon_container slds-var-m-left_xxx-small" title={collaborator.altText}>
                                <lightning-icon icon-name={collaborator.iconType}></lightning-icon>
                        </span>
                        <a href="#" class="slds-pill__action slds-truncate" title={collaborator.altText}>
                            <span class="slds-pill__label">{collaborator.mint__Collaborators_Email__c}</span>
                        </a>
                        <button class="slds-button slds-button_icon slds-button_icon slds-pill__remove" title="Remove">
                            <lightning-icon 
                                icon-name="utility:close" 
                                recordid={collaborator.Id}
                                data-emailaddress={collaborator.mint__Collaborators_Email__c}
                                onclick={removeCollaborator}>
                            </lightning-icon>
                            <span class="slds-assistive-text">Remove</span>
                        </button>
                    </span>
                </template>
            </template>

            <template if:false={get_foundCollaborators}>
                <div class="promptBox">
                    No Collaborators exist againt this Case as of yet.
                </div>
            </template>
        </div>

        <!-- <footer class="slds-card__footer slds-align_absolute-center" style="display: table;">
            Key: &ThickSpace;
            <div class="keyAccountCollab" 
                title="A Collaborator from this Cases Account. Automatically added as a Collaorator to each Case."
                style="display: table-cell;"
                >
                Account Collaborator
            </div>
            &ThickSpace;
            <div class="keyManualCollab" 
                title="A Collaborator that has been manually added to this Case. This does not affect other Cases"
                style="display: table-cell;"
                >
                Manually Added to Case
            </div>
            &ThickSpace;
            <div class="keyExcludedCollab" 
                title="A Collaborator that has been Excluded from this Case's Emails"
                style="display: table-cell;"
                >
                Excluded Collaborator
            </div>
        </footer> -->
    </div>

</template>